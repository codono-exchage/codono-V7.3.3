<include file="Public:header"/>
<script type="text/javascript" src="__THEME__/layer/laydate/laydate.js"></script>
<div id="main-content">
	<div id="top-alert" class="fixed alert alert-error" style="display: none;">
		<button class="close fixed" style="margin-top: 4px;">&times;</button>
		<div class="alert-content">{:l('Warnings')}</div>
	</div>
	<div id="main" class="main">
<div class="row">
    <div class="col-12">
        <div class="page-title-box d-sm-flex align-items-center justify-content-between">
            <h4 class="mb-sm-0 font-size-18">
                <a href="{:U('Article/link')}">{:l('Links')}</a>
            </h4>
            <div class="page-title-right">
                <ol class="breadcrumb m-0">
                    <li class="breadcrumb-item">
                        <a href="{:U('Article/link')}">{:l('Links')}</a>
                    </li>
                    <li class="breadcrumb-item active">
                        <empty name="data">{:l('Add a link')}<else/>{:l('Edit Link')}</empty>
                    </li>
                </ol>
            </div>
        </div>
    </div>
</div>

		<div class="card">
			<div class="card-body">
				<form id="form" action="{:U('Article/linkEdit')}" method="post" class="form-horizontal" enctype="multipart/form-data">
					<div id="tab" class="tab-pane in tab">
						<div class="form-item cf">
							<table class="table">
								<tr class="controls">
									<td class="item-label">{:l('Link Name')}:</td>
									<td>
										<input type="text" class="form-control input-10x" name="name" value="{$data.name}">
									</td>
									<td class="item-note"></td>
								</tr>
								<tr class="controls">
									<td class="item-label">{:l('Link Title')}:</td>
									<td>
										<input type="text" class="form-control input-10x" name="title" value="{$data.title}">
									</td>
									<td class="item-note"></td>
								</tr>
								
								
								
								
								<tr class="controls">
									<td class="item-label">{:l('linklogo')}:</td>
									<td>
										<div id="addpicContainer">
											<notempty name="data.img">
												<!--Noimagedisplaydefaultimage-->
												<img id="up_img" onclick="getElementById('inputfile').click()" style="cursor:pointer;max-width:400px;" title="Click to changeLOGOimage" alt="Click to changeLOGOimage" src="/Upload/link/{$data.img}">
												<else/>
												<!--Noimagedisplaydefaultimage-->
												<img id="up_img" onclick="getElementById('inputfile').click()" style="cursor:pointer;max-width:400px;" title="Click Add Picture" alt="Click Add Picture" src="__THEME__/images/addimg.png">
											</notempty>
											<input type="hidden" id="img" name="img" value="{$data.img}">
											<input type="file" id="inputfile" style="height:0;width:0;z-index: -1; position: absolute;left: 10px;top: 5px;" value=""/>
										</div>
									</td>
									<td class="item-note">{:l('strictly follow 90px*32px size')}</td>
								</tr>
								
								<tr class="controls">
									<td class="item-label">{:l('link address')}:</td>
									<td>
										<input type="text" class="form-control input-10x" name="url" value="{$data.url}">
									</td>
									<td class="item-note"></td>
								</tr>
								<tr class="controls">
									<td class="item-label">{:l('add time')}:</td>
									<td>
										<input type="text" class="form-control  input-10x " name="addtime" value="{$data['addtime']|addtime}" onclick="laydate({istime: true, format: 'YYYY-MM-DD hh:mm:ss'})">
									</td>
									<td class="item-note"></td>
								</tr>
								<tr class="controls">
									<td class="item-label">{:l('Edit time')}:</td>
									<td>
										<input type="text" class="form-control  input-10x " name="endtime" value="{$data['endtime']|addtime}" onclick="laydate({istime: true, format: 'YYYY-MM-DD hh:mm:ss'})">
									</td>
									<td class="item-note"></td>
								</tr>
								<tr class="controls">
									<td class="item-label">{:l('Sequence')}:</td>
									<td>
										<input type="text" class="form-control input-10x" name="sort" value="{$data.sort}">
									</td>
									<td class="item-note"></td>
								</tr>
								<tr class="controls">
									<td class="item-label">{:l('Status')}:</td>
									<td><select name="status" class="form-select input-10x">
										<option value="1"
										<eq name="data.status" value="1">{:l('selected')}</eq>
										>{:l('Enabled')}</option>
										<option value="0"
										<eq name="data.status" value="0">{:l('selected')}</eq>
										>{:l('Disable')}</option>
									</select></td>
									<td class="item-note"></td>
								</tr>
								<tr class="controls">
									<td class="item-label"></td>
									<td>
										<div class="form-item cf">
											<button class="btn submit-btn ajax-post btn-info" id="submit" type="submit" target-form="form-horizontal">{:l('Submit')}</button>
											<a class="btn btn-return btn-warning" href="{$Think.server.HTTP_REFERER}">{:l('Back')}</a>
											<notempty name="data.id"><input type="hidden" name="id" value="{$data.id}"/>
											</notempty>
										</div>
									</td>
								</tr>
							</table>
						</div>
					</div>
				</form>
				<script type="text/javascript">
					//submit Form
					$('#submit').click(function () {
						$('#form').submit();
					});
					
					
					
					$(document).ready(function () {
						//The response fileAdd tosuccessevent
						$("#inputfile").change(function () {
							//createFormDataObjects
							var data = new FormData();
							//forFormDataAdding Data Object
							$.each($('#inputfile')[0].files, function (i, file) {
								data.append('upload_file' + i, file);
							});


							//send data
							$.ajax({
								url: '/Admin/Article/linkimage',
								type: 'POST',
								data: data,
								cache: false,
								contentType: false,		//Essential parameters
								processData: false,		//Essential parameters
								success: function (data) {
									if (data) {
										$('#up_img').attr("src", '/Upload/link/' + data);
										$('#img').val(data);
										$('#up_img').show();
									}
								},
								error: function () {
									alert('Upload error');
									$(".loading").hide();	//plusUpload failedshiftexceptplusLoadimage
								}
							});

						});
					});
					
					
					
					
					
					
					
					
				</script>
			</div>
		</div>
	</div>
</div>





<include file="Public:footer"/>
<block name="script">
	<script type="text/javascript" charset="utf-8">
		//Highlight navigation
		highlight_subnav("{:U('Article/link')}");
	</script>
</block>