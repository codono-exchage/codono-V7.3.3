<include file="Public:header" />
<script type="text/javascript" src="__THEME__/layer/laydate/laydate.js"></script>
<div id="main-content">
	<div id="top-alert" class="fixed alert alert-error" style="display: none;">
		<button class="close fixed" style="margin-top: 4px;">&times;</button>
		<div class="alert-content">{:l('Warnings')}</div>
	</div>
	<div id="main" class="main">
		<div class="main-title-h">
			<span class="d-sm-flex align-items-center justify-content-between h4"><a href="{:U('Issue/index')}">{:l('ICO
					Management')}</a> >></span> <span class="d-sm-flex align-items-center justify-content-between h4">
				<empty name="data">{:l('Add ICO')}
					<else />{:l('Edit ICO')}
				</empty>
			</span>
		</div>
		<div class="card">
			<div class="card-body">
				<form id="form" action="{:U('Issue/save')}" method="post" class="form-horizontal">
					<div id="tab" class="tab-pane in tab">
						<div class="form-item cf">
							<table class="table">
								<tr class="controls">
									<td class="item-label">{:l('ICO name')}:</td>
									<td>
										<input type="text" class=" form-control input-10x " name="name"
											value="{$data.name}">
									</td>
									<td class="item-note"></td>
								</tr>
								<tr class="controls">
									<td class="item-label">{:l('ICO currency')}:</td>
									<td><select name="coinname" class="form-select input-10x">
											<volist name="C['coin_list']" id="v">
												<option value="{$v['name']}" <eq name="data['coinname']"
													value="$v['name']">{:l('selected')}</eq>
													>{$v['title']}</option>
											</volist>
										</select></td>
									<td class="item-note">{:l('User buy owned')}</td>
								</tr>
								<tr class="controls">
									<td class="item-label">{:l('Price Currency')}:</td>
									<td><select name="buycoin" class="form-select input-10x">
											<volist name="C['coin']" id="v">
												<option value="{$v['name']}" <eq name="data['buycoin']"
													value="$v['name']">{:l('selected')}</eq>
													>{$v['title']}</option>
											</volist>
										</select></td>
									<td class="item-note">{:l('Static Price')}</td>
								</tr>
								<tr class="controls">
									<td class="item-label">{:l('ICO price')}:</td>
									<td>
										<input type="text" class="form-control  input-10x " name="price"
											value="{$data['price']}">
									</td>
									<td class="item-note">Buy 1 {$data['coinname']} for {$data['price']}
										{$data['buycoin']}</td>
								</tr>

								<tr class="controls">
									<td class="item-label">{:l('Payment Coins')}:</td>
									<td>
										<div style="width: 500px;text-align: left">
											<volist name="appCon.show_coin" id="show_coin">
												<label style="margin-left: 15px;"><input name="show_coin[]"
														type="checkbox" <eq name="show_coin.flag"
														value="1">{:l('checked')}</eq>
													value="{$show_coin['name']|strtolower}"/>{$show_coin['name']}
												</label>
											</volist>
										</div>
									</td>
									<td class="item-note"></td>
								</tr>


								<tr class="controls">
									<td class="item-label">{:l('ICO Image')}:</td>
									<td>
										<div id="addpicContainer">
											<notempty name="data.image">
												<img id="up_img" onclick="getElementById('inputfile').click()"
													style="cursor:pointer;max-width:200px;" title="Click Add Picture"
													alt="Click Add Picture" src="/Upload/issue/{$data.image}">
												<else />
												<img id="up_img" onclick="getElementById('inputfile').click()"
													style="cursor:pointer;max-width:200px;" title="Click Add Picture"
													alt="Click Add Picture" src="__THEME__/images/addimg.png">
											</notempty>
											<input type="hidden" id="image" name="image" value="{$data.image}">
											<input type="file" id="inputfile"
												style="height:0;width:0;z-index: -1; position: absolute;left: 10px;top: 5px;"
												value="" />
										</div>
									</td>
									<td class="item-note">{:l('Image Size')} 837px*628px</td>
								</tr>
								<tr class="controls">
									<td class="item-label">{:l('Show on Homepage')}:</td>
									<td>
										<select name="homepage" class="form-select  input-10x">
											<option value="0" <eq name="data.homepage" value="0">{:l('selected')}</eq>
												>{:l('No')}</option>
											<option value="1" <eq name="data.homepage" value="1">{:l('selected')}</eq>
												>{:l('Yes')}</option>
										</select>
									</td>
									<td class="item-note"></td>
								</tr>
								<tr class="controls">
									<td class="item-label">{:l('Staff Pick')}:</td>
									<td>
										<select name="tuijian" class="form-select  input-10x">
											<option value="2" <eq name="data.tuijian" value="2">{:l('selected')}</eq>
												>{:l('No')}</option>
											<option value="1" <eq name="data.tuijian" value="1">{:l('selected')}</eq>
												>{:l('Yes')}</option>
										</select>
									</td>
									<td class="item-note"></td>
								</tr>


								<tr class="controls">
									<td class="item-label">{:l('Sort')}:</td>
									<td>
										<input type="text" class="form-control input-10x " name="paixu"
											value="{$data['paixu']*1}">

									</td>
									<td class="item-note">{:l('Higher the value , more the forward')}</td>
								</tr>
								<tr class="controls">
									<td class="item-label">{:l('Video Link')}:</td>
									<td>
										<input type="text" class="form-control input-10x " name="video"
											value="{$data['video']}">

									</td>
									<td class="item-note">{:l('Youtube Link')}</td>
								</tr>
								<tr class="controls">
									<td class="item-label">{:l('ICOBench name')}:</td>
									<td>
										<input type="text" class="form-control input-10x " name="icobench"
											value="{$data['icobench']}">

									</td>
									<td class="item-note">{:l('Enter name only: Ex alphax')}</td>
								</tr>
								<tr class="controls">
									<td class="item-label">{:l('ICOMark Handle')}:</td>
									<td>
										<input type="text" class="form-control input-10x " name="icomark"
											value="{$data['icomark']}">

									</td>
									<td class="item-note">{:l('Enter handle only')}</td>
								</tr>

								<tr class="controls">
									<td class="item-label">{:l('Facebook')}:</td>
									<td>
										<input type="text" class="form-control input-10x " name="facebook"
											value="{$data['facebook']}">

									</td>
									<td class="item-note">{:l('Facebook Page URL')}</td>
								</tr>
								<tr class="controls">
									<td class="item-label">{:l('Twitter')}:</td>
									<td>
										<input type="text" class="form-control input-10x " name="twitter"
											value="{$data['twitter']}">

									</td>
									<td class="item-note">{:l('Twitter URL')}</td>
								</tr>
								<tr class="controls">
									<td class="item-label">{:l('Telegram')}:</td>
									<td>
										<input type="text" class="form-control input-10x " name="telegram"
											value="{$data['telegram']}">

									</td>
									<td class="item-note">{:l('Telegram URL')}</td>
								</tr>
								<tr class="controls">
									<td class="item-label">{:l('Token Owner')}:</td>
									<td>
										<input type="text" class="form-control input-10x " name="ownerid"
											value="{$data['ownerid']}">

									</td>
									<td class="item-note">{:l('Userid of owner example 3124545, Leave 0 for no owner')}
									</td>
								</tr>

								<tr class="controls">
									<td class="item-label">{:l('Site Commission')}:</td>
									<td>
										<input type="text" class="form-control input-10x " name="commission"
											value="{$data['commission']}">

									</td>
									<td class="item-note">{:l('Commision in % [example 12.5%]')}</td>
								</tr>
								<tr class="controls">
									<td class="item-label">{:l('Total Supply')}:</td>
									<td>
										<input type="text" class="form-control input-10x " name="num"
											value="{$data['num']*1}">
									</td>
									<td class="item-note"></td>
								</tr>
								<tr class="controls">
									<td class="item-label">{:l('Amount subscribed')}:</td>
									<td>
										<input type="text" class="form-control  input-10x " name="deal"
											value="{$data['deal']*1}">
									</td>
									<td class="item-note"></td>
								</tr>

								<tr class="controls">
									<td class="item-label">{:l('ICO limit')}:</td>
									<td>
										<input type="text" class="form-control  input-10x " name="limit"
											value="{$data.limit}">
									</td>
									<td class="item-note"></td>
								</tr>
								<tr class="controls">
									<td class="item-label">{:l('Start Date')}:</td>
									<td>
										<input type="text" class="form-control  input-10x " name="time"
											value="{$data['time']}"
											onclick="laydate({istime: true, format: 'YYYY-MM-DD hh:mm:ss'})">
									</td>
									<td class="item-note"></td>
								</tr>
								<tr class="controls">
									<td class="item-label">{:l('ICO period')}:</td>
									<td>
										<input type="text" class="form-control  input-10x " name="tian"
											value="{$data['tian']}">
									</td>
									<td class="item-note">{:l('Days')}</td>
								</tr>
								<tr class="controls" style="display:none;">
									<td class="item-label">{:l('Time')}:</td>
									<td>
										<input type="text" class="form-control  input-10x " name="ci" value="0">
									</td>
									<td class="item-note">{:l('Secondary')}</td>
								</tr>
								<tr class="controls">
									<td class="item-label">{:l('Unfreeze Time')}:</td>
									<td>
										<input type="text" class="form-control  input-10x " name="jian" value="0">
									</td>
									<td class="item-note">{:l('Hours')}</td>
								</tr>
								<tr class="controls">
									<td class="item-label">{:l('Minimum Single')}:</td>
									<td>
										<input type="text" class="form-control  input-10x " name="min"
											value="{$data['min']}">
									</td>
									<td class="item-note">{:l('Minimum Buy')}</td>
								</tr>
								<tr class="controls">
									<td class="item-label">{:l('Max Buy largest')}:</td>
									<td>
										<input type="text" class="form-control  input-10x " name="max"
											value="{$data['max']}">
									</td>
									<td class="item-note">{:l('One person buy limit')}</td>
								</tr>
								<tr class="controls">
									<td class="item-label">Bonus Currency:</td>
									<td><select name="invit_coin" class="form-select  input-10x">
											<volist name="C['coin']" id="v">
												<option value="{$v['name']}" <eq name="data['invit_coin']"
													value="$v['name']">{:l('selected')}</eq>
													>{$v['title']}</option>
											</volist>
										</select></td>
									<td class="item-note">{:l('Bonus')}</td>
								</tr>
								<tr class="controls">
									<td class="item-label">{:l('Bonus 1st Referrer')}:</td>
									<td>
										<input type="text" class="form-control  input-10x " name="invit_1"
											value="{$data['invit_1']}">
									</td>
									<td class="item-note">%</td>
								</tr>
								<tr class="controls">
									<td class="item-label">{:l('Bonuses 2nd Tier')}:</td>
									<td>
										<input type="text" class="form-control  input-10x " name="invit_2"
											value="{$data['invit_2']}">
									</td>
									<td class="item-note">%</td>
								</tr>
								<tr class="controls">
									<td class="item-label">{:l('Bonus 3rd Tier')}:</td>
									<td>
										<input type="text" class="form-control  input-10x " name="invit_3"
											value="{$data['invit_3']}">
									</td>
									<td class="item-note">%</td>
								</tr>
								<tr class="controls">
									<td class="item-label">{:l('Instructions')}:</td>
									<td><textarea name="content" id="content"
											class="form-control input-10x">{$data.content}</textarea></td>
									<td class="item-note"></td>
								</tr>
								<tr class="controls">
									<td class="item-label">{:l('Status')} :</td>
									<td><select name="status" class="form-select  input-10x">
											<option value="1" <eq name="data.status" value="1">{:l('selected')}</eq>
												>{:l('Enabled')}</option>
											<option value="0" <eq name="data.status" value="0">{:l('selected')}</eq>
												>{:l('Disable')}</option>
										</select></td>
									<td class="item-note"></td>
								</tr>
								<tr class="controls">
									<td class="item-label"></td>
									<td>
										<div class="form-item cf">
											<button class="btn submit-btn ajax-post btn-info" id="submit" type="submit"
												target-form="form-horizontal">Submit</button>

											<a class="btn btn-return btn-warning"
												href="{$Think.server.HTTP_REFERER}">{:l('Back')}</a>
											<notempty name="data.id"><input type="hidden" name="id"
													value="{$data.id}" />
											</notempty>
										</div>
									</td>
								</tr>
							</table>
						</div>
					</div>
				</form>
				<script type="text/javascript">
					function encodeContent() {
						var contentTextarea = document.getElementById("content");
						var encodedContent = encodeURIComponent(contentTextarea.value);
						contentTextarea.value = encodedContent;
						console.log(314, encodedContent);
					}
					//submit Form
					$('#submit').click(function () {
						encodeContent();
						$('#form').submit();
					});

				</script>
			</div>
		</div>
	</div>
</div>
<script type="text/javascript" src="__THEME__/kindeditor/kindeditor-min.js"></script>
<script type="text/javascript">
	var editor;
	KindEditor.ready(function (K) {
		editor = K.create('textarea[name="content"]', {
			width: '500px',
			height: '250px',
			allowPreviewEmoticons: false,
			allowImageUpload: true,
			items: [
				'source', 'fontname', 'fontsize', '|', 'forecolor', 'hilitecolor', 'bold', 'italic', 'underline',
				'removeformat', '|', 'justifyleft', 'justifycenter', 'justifyright', 'insertorderedlist',
				'insertunorderedlist', '|', 'emoticons', 'image', 'link', 'fullscreen'
			],
			filterMode: false,
			afterBlur: function () {
				this.sync();
			},
			filterMode: false  // This can help to keep HTML tags from being removed. Use with caution.
		});
		var htmlContent = editor.html();

	});



	$(document).ready(function () {
		//The response fileAdd tosuccessevent
		$("#inputfile").change(function () {
			//createFormDataObjects
			var data = new FormData();
			//forFormDataAdding Data Object
			$.each($('#inputfile')[0].files, function (i, file) {
				data.append('upload_file' + i, file);
			});


			//send data
			$.ajax({
				url: '/Admin/Issue/issueimage',
				type: 'POST',
				data: data,
				cache: false,
				contentType: false,		//Essential parameters
				processData: false,		//Essential parameters
				success: function (data) {
					if (data) {
						$('#up_img').attr("src", '/Upload/issue/' + data);
						$('#image').val(data);
						$('#up_img').show();
					}
				},
				error: function () {
					alert('Upload error');
					$(".loading").hide();	//plusUpload failedshiftexceptplusLoadimage
				}
			});

		});
	});

</script>
<include file="Public:footer" />
<block name="script">
	<script type="text/javascript" charset="utf-8">
		//Highlight navigation
		highlight_subnav("{:U('Issue/index')}");
	</script>
</block>