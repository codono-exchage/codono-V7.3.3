<!doctype html>
<html>
<head>
    <meta charset="UTF-8">
    <title> </title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta content="Enter 2FA " name="description" />
    
    <!-- App favicon -->
    <link rel="shortcut icon" href="__THEME__/assets/images/favicon.ico">

    <!-- owl.carousel css -->
    <link rel="stylesheet" href="__THEME__/assets/libs/owl.carousel/assets/owl.carousel.min.css">

    <link rel="stylesheet" href="__THEME__/assets/libs/owl.carousel/assets/owl.theme.default.min.css">

    <!-- Bootstrap Css -->
    <link href="__THEME__/assets/css/bootstrap.min.css" id="bootstrap-style" rel="stylesheet" type="text/css" />
    <!-- Icons Css -->
    <link href="__THEME__/assets/css/icons.min.css" rel="stylesheet" type="text/css" />
    <!-- App Css-->
    <link href="__THEME__/assets/css/app.min.css" id="app-style" rel="stylesheet" type="text/css" />
</head>
<body id="login-page">
<div id="main-content">
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <div class="text-center mb-5 text-muted">
                    <a href="/" class="d-block auth-logo">
                        <img src="__UPLOAD__/public/{:C('web_logo')}" alt="" height="18" class="auth-logo-dark">
                        <img src="__UPLOAD__/public/{:C('web_logo')}" alt="" height="18" class="auth-logo-light">
                    </a>
                    <p class="mt-3">{:l('Google 2FA')}</p>
                </div>
            </div>
        </div>
    <div class="row justify-content-center">
        <div class="col-md-8 col-lg-6 col-xl-5">
            <div class="card">

                <div class="card-body">

                    <div class="p-2">
                        <div class="text-center">

                            <div class="avatar-md mx-auto">
                                <div class="avatar-title rounded-circle bg-light">
                                    <i class="bx bxs-envelope h1 mb-0 text-primary"></i>
                                </div>
                            </div>
                            <div class="p-2 mt-4">

                                <h4>{:l('Verify Your 2FA')} </h4>


                                    <div  class="login-form">
            
                                        <div class="mb-3">
                                            
                                            <input type="password" class="form-control" id="userpassword" placeholder="Enter 2FA Code" name="gacode">
                                        </div>
            
                                        <div class="text-end">
                                            <button class="btn btn-primary w-md waves-effect waves-light" type="button"  onClick="unlock();">{:l('Unlock')}</button>
                                        </div>
    
                                    </div>

                            
                            </div>

                        </div>
                    </div>

                </div>
            </div>
 
</div>
<script type="text/javascript" src="__THEME__/js/jquery.min.js"></script>
<script type="text/javascript" src="__THEME__/layer/layer.js"></script>
<script type="text/javascript">
    function unlock() {
			var gacode = $('#userpassword').val();
			if (!gacode) {
				layer.tips('Enter 2fa 6 Digit Code', '#userpassword', {
					tips: [1, '#02b5c2']
				});
				return;
			}

			$.post("{:U('Login/check2fa')}", { gacode: gacode }, function (data) {
				layer.msg(data.info);
				if (data.url) {
					window.location.href = data.url;
				}
			}, 'json');
		}
    $(".login-form").on("focus", "input", function () {
        $(this).closest('.item').addClass('focus');
    }).on("blur", "input", function () {
        $(this).closest('.item').removeClass('focus');
    });

    //Form submission
    $(document).ajaxStart(function () {
        $("button:submit").addClass("log-in").attr("disabled", true);
    }).ajaxStop(function () {
        $("button:submit").removeClass("log-in").attr("disabled", false);
    });

    $("form").submit(function () {
        var self = $(this);
        $.post(self.attr("action"), self.serialize(), success, "json");
        return false;

        function success(data) {
            if (data.status) {
                window.location.href = data.url;
            } else {
                self.find(".check-tips").text(data.info);
            }
        }
    });

    $(function () {
        //Initialization electioninUsernameloseEnterframe
        $("#itemBox").find("input[name=username]").focus();

        function isPlaceholer() {
            var input = document.createElement('input');
            return "placeholder" in input;
        }

        //If it does not
        if (!isPlaceholer()) {
            $(".placeholder_copy").css({
                display: 'block'
            })
            $("#itemBox input").keydown(function () {
                $(this).parents(".item").next(".placeholder_copy").css({
                    display: 'none'
                })
            })
            $("#itemBox input").blur(
                    function () {
                        if ($(this).val() == "") {
                            $(this).parents(".item").next(
                                    ".placeholder_copy").css({
                                display: 'block'
                            })
                        }
                    })

        }
    });
</script>
</body>
</html>