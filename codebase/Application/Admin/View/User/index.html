<include file="Public:header"/>
<div id="main-content">
	<div id="top-alert" class="fixed alert alert-error" style="display: none;">
		<button class="close fixed" style="margin-top: 4px;">&times;</button>
		<div class="alert-content">{:l('Warnings')}</div>
	</div>
	<div id="main" class="main">
		<div class="row">
			<div class="col-12">
				<div class="page-title-box d-sm-flex align-items-center justify-content-between">
					<h4 class="mb-sm-0 font-size-18">{:l('User Manager')}</h4>
				</div>
			</div>
		</div>
		
		<div class="card card-body mt-2 mb-2 table-responsive">
		
				<div class="d-flex flex-wrap gap-2 tomato-1 mb-1">
				<a class="btn btn-success  " href="{:U('User/edit')}">{:l('Add')}</a>
	
					<button class="ajax-post btn  btn-info " url="{:U('User/status',array('type'=>'idauth'))}" target-form="ids">{:l('Certify KYC')}</button>
					<button class="ajax-post btn  btn-warning  ajax-post" url="{:U('User/status',array('type'=>'notidauth'))}" target-form="ids">{:l('Reject KYC')}</button>
	
					<button class="ajax-post btn  btn-info " url="{:U('User/status',array('type'=>'resume'))}" target-form="ids">{:l('Enable')}</button>
					<button class="ajax-post btn  btn-warning  ajax-post" url="{:U('User/status',array('type'=>'forbid'))}" target-form="ids">{:l('Disable')}</button>
					<button class="btn ajax-post confirm btn-danger " url="{:U('User/status',array('type'=>'del'))}" target-form="ids"><i class="far fa-trash-alt" title="Delete"></i></button>
					
				
						<form name="formSearch" id="formSearch" method="get"  class="d-flex align-items-center">
							<select  name="status" class="form-select me-2">
								<option value=""
								<empty name="Think.get.status">{:l('selected')}</empty>
								>{:l('All states')}</option>
	
								<option value="7"
								<eq name="Think.get.status" value="7">{:l('selected')}</eq>
								>{:l('KYC Not Submitted')}</option>
								<option value="6"
								<eq name="Think.get.status" value="6">{:l('selected')}</eq>
								>{:l('KYC Pending Review')}</option>
								<option value="5"
								<eq name="Think.get.status" value="5">{:l('selected')}</eq>
								>{:l('KYC Approved')}</option>
								<option value="8"
								<eq name="Think.get.status" value="8">{:l('selected')}</eq>
								>{:l('KYC Rejected')}</option>
								<option value="1"
								<eq name="Think.get.status" value="1">{:l('selected')}</eq>
								>{:l('Disabled Status')}</option>
								<option value="2"
								<eq name="Think.get.status" value="2">{:l('selected')}</eq>
								>{:l('Enabled status')}</option>
							</select>
							<select  name="field" class="form-select me-2">
								<option value="email"
								<eq name="Think.get.field" value="email">{:l('selected')}</eq>
								>{:l('Email')}</option>
								<option value="username"
								<eq name="Think.get.field" value="username">{:l('selected')}</eq>
								>{:l('Username')}</option>
								<option value="cellphone"
								<eq name="Think.get.field" value="cellphone">{:l('selected')}</eq>
								>{:l('PHONE_NUMBER')}</option>
								<option value="truename"
								<eq name="Think.get.field" value="truename">{:l('selected')}</eq>
								>{:l('Truename')}</option>
								<option value="id"
								<eq name="Think.get.field" value="id">{:l('selected')}</eq>
								>{:l('UserID')}</option>
							</select>
							<input type="text" name="name" class="search-input form-control  " value="{$Think.get.name}" placeholder="Enter text to search" >
							<a class="sch-btn" href="javascript:;" id="search"> <i class="btn-search"></i> </a>
						</form>
						<script>
							//Search function
							$(function () {
								$('#search').click(function () {
									$('#formSearch').submit();
								});
							});
							//Enter search
							$(".search-input").keyup(function (e) {
								if (e.keyCode === 13) {
									$("#search").click();
									return false;
								}
							});
						</script>
					</div>
				
		
			<table class="table table-sm emptyx">
				<thead class="table-light">
				<tr>
					<th class="row-selected row-selected">
						<input class="check-all" type="checkbox"/>
					</th>
					<th class="">{:l('UID')}</th>
					<th class="">{:l('Username')}</th>
					<th class="">{:l('Email')}</th>
					<th class="d-none d-md-table-cell">Full Name</th>
					<th class="d-none d-md-table-cell">{:l('KYC')}</th>
			
					<th class="d-none d-md-table-cell">{:l('Docs')}</th>
					<th class="">{:l('Status')}</th>
					<th class="d-none d-md-table-cell">{:l('IP')}</th>
					<th class="">{:l('Option')}</th>
				</tr>
				</thead>
				<tbody>
				<notempty name="list">
					<volist name="list" id="vo">
						<tr>
							<td>
								<input class="ids" type="checkbox" name="id[]" value="{$vo.id}"/>
							</td>
							<td>{$vo.id}</td>
							<td>{$vo.username}</td>
							<td class=""><if condition="$vo['email']">{$vo.email}<else/>-</if></td>
							<td class="d-none d-md-table-cell">{$vo.truename}</td>
							<td class="d-none d-md-table-cell">
								<eq name="vo.idcardauth" value="0"><font color='black'><span class="fa fa-exclamation-triangle" aria-hidden="true" title="Not Submitted"></span></font></eq>
								<eq name="vo.idcardauth" value="1"><font color='green'><span class="fa fa-check-circle" aria-hidden="true" title="Passed"></span></font></eq>
								<eq name="vo.idcardauth" value="2"><font color='orange'><span class="fa fa-question-circle" aria-hidden="true" title="Pending Review"></span></font></eq>
								<eq name="vo.idcardauth" value="3"><font color='red'><span class="fa fa-times-circle" aria-hidden="true" title="Rejected"></span></font></eq>
							</td>
							<td class="d-none d-md-table-cell">
								<neq name="vo.idcardimg1" value="">
									<span style="color:green" class="fa fa-check" aria-hidden="true" title="UPLOADED"></span> <notempty name="vo"><span class="fa fa-info-circle" aria-hidden="true" title="{$vo.idcardinfo}"></span></notempty>
									
								<else/>
									<font color='red'>---</font>
								</neq>
							</td>


							<td>
								<eq name="vo.status" value="0"><span style="color:red" class="fas fa-times" aria-hidden="true" title="Disabled"></span></eq>
								<eq name="vo.status" value="1"><span style="color:green" class="fa fa-check" aria-hidden="true" title="Enabled"></span></eq>
							</td>
							<td class="d-none d-md-table-cell">
								<span class="fa fa-info-circle" aria-hidden="true" title="from {$vo.addip} on {$vo.addtime|addtime} "></span></td>
							<td>
								<div class="btn-toolbar " role="toolbar">
									<div class="btn-group btn-group-sm me-2 mb-sm-0">
										
										<a href="javascript:apikeys({$vo.id});" type="button" class="d-none d-md-table-cell  btn btn-primary waves-light waves-effect"><i class="fa fa-code"></i></a>
										<a href="{:U('User/edit?id='.$vo['id'])}" class=" btn btn-primary waves-light waves-effect" ><i class="far fa-edit"></i></a>
										<button type="button" class="  btn btn-primary waves-light waves-effect " data-bs-toggle="dropdown" aria-expanded="false">
											More <i class="mdi mdi-dots-vertical ms-2"></i>
										</button>
										<div class="  dropdown-menu">
											<a class="dropdown-item" href="{:U('User/coin?field=username&name='.$vo['username'])}">{:l('Spot Balances')}</a>
											<a class="dropdown-item" href="{:U('User/assets?field=username&name='.$vo['username'])}">{:l('Other Balances')}</a>
											<a class="dropdown-item" href="{:U('User/log?field=username&name='.$vo['username'])}">{:l('Logins')}</a>
											<a class="dropdown-item" href="{:U('User/wallet?field=username&name='.$vo['username'])}">{:l('CryptoOut Address')}</a>
											<a class="dropdown-item" href="{:U('User/bank?field=username&name='.$vo['username'])}">{:l('FiatOut Address')}</a>
											
											<a class="dropdown-item" href="{:U('Finance/index?field=username&name='.$vo['username'])}">{:l('Finance Activity')}</a>
											<a class="dropdown-item" href="{:U('Finance/mycz?field=username&name='.$vo['username'])}">{:l('Fiat Deposit')}</a>
											<a class="dropdown-item" href="{:U('Finance/mytx?field=username&name='.$vo['username'])}">{:l('Fiat Withdrawal')}</a>
											<a class="dropdown-item" href="{:U('Finance/myzr?field=username&name='.$vo['username'])}">{:l('Crypto Deposit')}</a>
											<a class="dropdown-item" href="{:U('Finance/myzc?field=username&name='.$vo['username'])}">{:l('Crypto Withdrawal')}</a>
										</div>
									</div>
								
									<!--<div class="btn-group me-2 mb-2 mb-sm-0">
										<button type="button" class="btn btn-primary waves-light waves-effect" data-bs-toggle="dropdown" aria-expanded="false">
											<i class="fa fa-tag"></i> <i class="mdi mdi-chevron-down ms-1"></i>
										</button>
										<div class="dropdown-menu">
											<a class="dropdown-item" href="{:U('Trade/index?field=username&name='.$vo['username'])}">Open Orders </a>
											<a class="dropdown-item" href="{:U('Trade/index?field=username&name='.$vo['username'])}">Closed Orders </a>
											<a class="dropdown-item" href="{:U('Issue/log?field=username&name='.$vo['username'])}">ICO Logs</a>
										</div>
									
									</div>-->

									<div class="btn-group me-2 mb-2 mb-sm-0">
										
									</div>
								</div>
								

							</td>
						</tr>
					</volist>
					<else/>
					<td colspan="12" class="text-center">{:l('No contents!')}</td>
				</notempty>
				</tbody>
			</table>
			<div class="page">
				<div>{$page}</div>
			</div>
		</div>
	</div>
</div>
<include file="Public:footer"/>
<block name="script">
	<script type="text/javascript" charset="utf-8">
	function apikeys(userid){
	
	$.get('/Admin/User/apikeys/userid/'+userid,  function (jsonresult) {
			var data = JSON.parse(jsonresult);

			if (data.status == 1) {
			htmlcontent="<table class='table table-responsive table-striped'><tr><td>Username:</td><td>"+data.username+"</td></tr><tr><td>ID:</td><td>"+data.id+"</td></tr><tr><td>TOKEN</td><td>"+data.apikey+"</td></tr></table>";
                        layer.open({
							title: 'API Keys',	
                            type: 1,
                            skin: 'layui-layer-demo', //styleclassname
                            closeBtn: 0, //Close button does not show
                            shift: 2,
                            shadeClose: true, //Open mask Close
                            content: htmlcontent
                        });
			}
			else {
				layer.msg(data.info, {icon: 2});
				if (data.url) {
					window.location = data.url;
				}
			}
			
		  });
}
		//Highlight navigation
		highlight_subnav("{:U('User/index')}");
	</script>
</block>